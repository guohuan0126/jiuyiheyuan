<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duanrong.business.app.mapper.AppFeedback">
	<resultMap type="AppFeedback" id="AppFeedbackRM">
		<id property="id" column="id" />
		<result property="osName" column="os_name" />
		<result property="content" column="content" />
		<result property="time" column="time" />
		<result property="contact" column="mobile_number" />
		<result property="realname" column="realname" />
		<result property="userId" column="user_id" />
		<result property="handleType" column="handle_type" />
	</resultMap>
    
    <!-- 插入 -->
	<insert id="insert" parameterType="AppFeedback">
		INSERT INTO app_feedback
		(os_name, content)
		VALUES
		(#{osName}, #{content})
	</insert>
	
	<!-- 分页查询 -->
	<select id="pageLite" parameterType="AppFeedback" resultMap="AppFeedbackRM" >
	  	SELECT `app_feedback`.contact_information as mobile_number ,user.realname, app_feedback.* FROM
		app_feedback LEFT JOIN `user` ON user_id = `user`.id
		<where>
		<if test="osName != null and osName != '' ">
			and app_feedback.os_name =#{osName}
		</if>
		<if test="startTime != null and startTime != '' ">
			and app_feedback.time &gt;=#{startTime}
		</if>
		<if test="endTime != null and endTime != '' ">
			and app_feedback.time &lt;=#{endTime}
		</if>
		</where>
		ORDER BY time DESC
	</select>
	
	<update id="updateChangeHandleType" parameterType="map">
		update app_feedback 
		<set>
		handle_type=#{handleType}
		</set>
		where id=#{id}
	</update>
</mapper>