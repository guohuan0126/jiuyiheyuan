<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duanrong.business.message.mapper.MessageTemplateMapper">
	<!-- 短信  -->
	<resultMap type="MessageTemplate" id="textRM">
		<id property="id" column="id"/>
		<result property="description" column="description"/>
		<result property="name" column="name"/>
		<result property="status" column="status"/>
		<result property="template" column="template"/>
		<result property="messageWay" column="message_way"/>
		<result property="messageNode" column="message_node"/>
		<result property="lastModifyTime" column="last_modify_time"/>
		<result property="nowStatus" column="display"/>
		<result property="textuserId" column="user_id"/>
	</resultMap>
	<select id="readSqlLiteForMessageTemplate" parameterType="MessageTemplate" resultMap="textRM">
		SELECT id,description,name,status,message_way,template,last_modify_time,user_id,display FROM user_message_template	
		<where>
			<if test="id != null and id != ''">
				and id like '%${id}%'
			</if>
			<if test="name != null and name != ''">
				and name like '%${name}%'
			</if>
				and display =1
		</where>
		ORDER BY last_modify_time DESC
		
	</select>

	<select id="readListMessageTemplate" resultMap="textRM">
		SELECT id,description,name,status,message_way,template,last_modify_time,user_id,display FROM user_message_template	ORDER BY last_modify_time
	</select>
	<update id="updateMessageTemplate" parameterType="MessageTemplate">
		UPDATE user_message_template
		<set>
			<if test="description != null and description != '' ">
				description = #{description},
			</if>
			<if test="name != null and name != '' ">
				name = #{name},
			</if>			
			<if test="template != null and template != '' ">
				template = #{template},
			</if>
			<if test="messageNode != null and messageNode != '' ">
				message_node = #{messageNode},
			</if>
			<if test="messageWay != null and messageWay != '' ">
				message_Way = #{messageWay},
			</if>
			<if test="lastModifyTime != null and lastModifyTime != ''">
				last_modify_time = #{lastModifyTime},
			</if>
			<if test="nowStatus != null">
				display= #{nowStatus},
			</if>
			<if test="textuserId != null and textuserId != ''">
				user_id = #{textuserId},
			</if>
		</set>
		WHERE id=#{id}
	</update>
	<insert id="insertMessageTemplate" parameterType="MessageTemplate">
		insert into user_message_template(id,description,name,status,template,message_way,message_node,last_modify_time,user_id,display) values(#{id},
		#{description},#{name},#{status},#{template},#{messageWay},#{messageNode},#{lastModifyTime},#{textuserId},#{nowStatus})
	</insert>
	<select id="readMessageTemplateById" parameterType="string" resultMap="textRM">
		select id,description,name,status,message_way,template,last_modify_time,user_id,display from user_message_template where id=#{id}		
	</select>
	<select id="readMessageTemplateByName" parameterType="string" resultMap="textRM">
		select id,description,name,status,message_way,template,last_modify_time,user_id,display from user_message_template where name=#{name}		
	</select>
</mapper>