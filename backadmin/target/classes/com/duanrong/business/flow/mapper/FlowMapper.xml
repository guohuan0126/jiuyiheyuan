<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duanrong.business.flow.mapper.FlowMapper">
	<resultMap type="flow" id="flowRM">
		<id property="flowId" column="flow_id" />
		<result property="flowName" column="flow_name" />
		<result property="description" column="description" />
		<result property="status" column="status" />
		
	</resultMap>	
	  
    <select id="pageLite" parameterType="flow" resultMap="flowRM">
    	SELECT * FROM flow WHERE status != 0
    	<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(flowId)">
    		AND flow_id = #{flowId}
    	</if>
    	<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(flowName) ">
    		AND flow_name LIKE '%${flowName}%'
    	</if>
    	<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(description)">
    		AND description LIKE '%${description}%'
    	</if>
    	<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(status)">
    			AND status LIKE '%${status}%'
    	</if> 	
    	ORDER BY flow_id
    </select>
    
    <select id="get" parameterType="flow" resultMap="flowRM">
    	SELECT * FROM flow WHERE flow_id = #{id}	   	
    </select>
    
    <!-- useGeneratedKeys="true"抓取插入数据主键      keyProperty="flowId" 主键返回字段  -->
    <insert id="insert" parameterType="flow" useGeneratedKeys="true" keyProperty="flowId">
    	INSERT INTO flow(flow_name, description, status) VALUES(#{flowName}, #{description}, #{status});        
    </insert>

	<update id="update" parameterType="flow">
	
		UPDATE flow
		<set>
			<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(flowName)">
				flow_name=#{flowName},
			</if>
			<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(description)">
				description=#{description},
			</if>
			<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(status)">
				status=#{status},
			</if>
		</set>
		WHERE flow_id=#{flowId}
	</update>
	
	<update id="deleteFlowById" parameterType="int">
    	UPDATE flow SET status=0 WHERE flow_id=#{flowId}   	
    </update>
</mapper>