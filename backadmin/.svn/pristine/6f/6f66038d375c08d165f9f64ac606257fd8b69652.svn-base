package com.duanrong.business.account.dao.impl;

import java.util.List;

import org.springframework.stereotype.Repository;

import base.dao.impl.BaseDaoImpl;
import base.pagehelper.PageHelper;
import base.pagehelper.PageInfo;

import com.duanrong.business.account.dao.UserAccountDao;
import com.duanrong.business.account.model.UserAccount;
import com.duanrong.business.account.model.UserBill;

@Repository
public class UserAccountDaoImpl extends BaseDaoImpl<UserAccount> implements
		UserAccountDao {

	public UserAccountDaoImpl() {
		this.setMapperNameSpace("com.duanrong.business.account.mapper.UserAccountMapper");
	}

	@Override
	public UserBill getLastUserBillByUserId(String userId) {
		return this.getSqlSession().selectOne(
				this.getMapperNameSpace() + ".getLastUserBillByUserId", userId);
	}

	@Override
	public void insertUserBill(UserBill userBill) {
		this.getSqlSession().insert(
				this.getMapperNameSpace() + ".insertUserBill", userBill);
	}

	@Override
	public PageInfo<UserBill> pageLite(int pageNo, int pageSize,
			UserBill userBill) {
		PageHelper.startPage(pageNo, pageSize);

		List<UserBill> list = getSqlSession().selectList(
				this.getMapperNameSpace() + ".pageLite", userBill);
		PageInfo<UserBill> pageInfo = new PageInfo<>(list);
		if (pageNo > pageInfo.getLastPage()) {
			pageInfo.setResults(null);
		}
		return pageInfo;
	}

	public PageInfo<UserAccount> getUserAccounts(int pageNo, int pageSize,String userId) {
		PageHelper.startPage(pageNo, pageSize);

		List<UserAccount> list = this.getSqlSession().selectList(
				this.getMapperNameSpace() + ".getUserAccounts", userId);
		PageInfo<UserAccount> pageInfo = new PageInfo<>(list);
		if (pageNo > pageInfo.getLastPage()) {
			pageInfo.setResults(null);
		}
		return pageInfo;
	}

}
