<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duanrong.business.demand.mapper.DemandtreasureGuOutMapper">
	<resultMap type="DemandtreasureGuOut" id="DemandtreasureGuOutRM">
		<id property="id" column="id" />
		<result property="userId" column="user_id" />
		<result property="money" column="money" />
		<result property="sendedTime" column="sended_time" />
		<result property="confirmTime" column="confirm_time" />
		<result property="freezeTime" column="freeze_time" />
		<result property="transferWay" column="trnsfer_way" />
		<result property="status" column="status" />
		<result property="type" column="type" />
		<result property="requestXml" column="request_xml" />
		<result property="responseXml" column="response_xml" />
		<result property="confirmreqXml" column="confirm_req_xml" />
		<result property="confirmrespXml" column="confirm_resp_xml" />
		<association property="user" column="user_id"
			resultMap="com.duanrong.business.user.mapper.UserMapper.userRM"/>
	</resultMap>
	
	<insert id="insert" parameterType="DemandtreasureGuOut">
		INSERT INTO demand_treasure_GuOut(id, user_id, money, sended_time,status,request_xml) VALUES(#{id}, #{userId}, #{money}, #{sendedTime}, #{status},#{requestXml})
	</insert>
	<update id="update" parameterType="DemandtreasureGuOut">
		UPDATE demand_treasure_GuOut 
		<set>
			<if test="status != null">
				status=#{status},
			</if>
			<if test="freezeTime != null">
				freeze_time=#{freezeTime},
			</if>
			<if test="confirmTime != null">
				confirm_time =#{confirmTime},
			</if>
			<if test="responseXml != null">
				response_xml =#{responseXml},
			</if>
			<if test="confirmreqXml != null">
				confirm_req_xml =#{confirmreqXml},
			</if>
			<if test="confirmrespXml != null">
				confirm_resp_xml =#{confirmrespXml},
			</if>
		</set>
		WHERE id=#{id}
	</update>
	<select id="get" parameterType="string" resultMap="DemandtreasureGuOutRM">
		SELECT * FROM demand_treasure_GuOut where id=#{id}
	</select>
	<select id="pageInfo"  resultMap="DemandtreasureGuOutRM">
		select g.*,u.realname,u.mobile_number from demand_treasure_GuOut g LEFT JOIN  user u on g.user_id=u.id
		order by g.sended_time desc
	</select>
	<select id="findGuCount" resultType="double">
		select count(*) from demand_treasure_GuOut where status in('freeze','sended','fail')
	</select>
</mapper>