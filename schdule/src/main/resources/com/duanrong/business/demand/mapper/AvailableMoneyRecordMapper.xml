<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duanrong.business.demand.mapper.AvailableMoneyRecordMapper">
	<resultMap type="AvailableMoneyRecord" id="AvailableMoneyRecordRM">
		<id property="id" column="id" />
		<result property="money" column="money" />
		<result property="begintime" column="beginTime" />
		<result property="endtime" column="endTime" />
		<result property="status" column="status" />
		<result property= "expectTime" column="expect_time"/>
		<result property="operatorid" column="operatorid" />
		<result property= "type" column="type"/>
		<result property= "expiredMoney" column="expiredMoney"/>
		<result property= "realExpiredMoney" column="realExpiredMoney"/>
		<result property= "opendMoney" column="opendMoney"/>
	</resultMap>
  
    
	<update id="update" parameterType="AvailableMoneyRecord">
		UPDATE Demand_treasure_availableMoneyRecord 
		<set>
			<if test="money != null">
				money=#{money},
			</if>
			<if test="expectTime != null">
				expect_time=#{expectTime},
			</if>
			<if test="begintime != null">
				beginTime=#{begintime},
			</if>
			<if test="endtime != null">
				endTime =#{endtime},
			</if>
			<if test="type != null and type != '' ">
				type = #{type},
			</if>
			<if test="realExpiredMoney != null and realExpiredMoney != '' ">
				realExpiredMoney = #{realExpiredMoney},
			</if>		
		</set>
		WHERE id=#{id}
	</update>
	
	<!-- 获取最后一条记录 -->
	<select id="getEndLine"  resultMap="AvailableMoneyRecordRM">
		SELECT *
		FROM Demand_treasure_availableMoneyRecord where status=2 order by beginTime desc limit 1
	</select>
</mapper>